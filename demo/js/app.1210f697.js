(function(t){function e(e){for(var o,r,l=e[0],a=e[1],c=e[2],d=0,h=[];d<l.length;d++)r=l[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&h.push(i[r][0]),i[r]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o]);u&&u(e);while(h.length)h.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],o=!0,l=1;l<n.length;l++){var a=n[l];0!==i[a]&&(o=!1)}o&&(s.splice(e--,1),t=r(r.s=n[0]))}return t}var o={},i={app:0},s=[];function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=o,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],a=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=a;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"047d":function(t,e,n){},"14ba":function(t,e,n){"use strict";var o=n("e6c2"),i=n.n(o);i.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("h1",[t._v(" simple flowchart")]),n("div",{staticClass:"tool-wrapper"},[n("div",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.newNodeType,expression:"newNodeType"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.newNodeType=e.target.multiple?n:n[0]}}},t._l(t.nodeCategory,(function(e,o){return n("option",{key:o,domProps:{value:o}},[t._v(t._s(e))])})),0),n("input",{directives:[{name:"model",rawName:"v-model",value:t.newNodeLabel,expression:"newNodeLabel"}],attrs:{type:"text",placeholder:"Input node label"},domProps:{value:t.newNodeLabel},on:{input:function(e){e.target.composing||(t.newNodeLabel=e.target.value)}}}),n("button",{on:{click:t.addNode}},[t._v("ADD")])]),n("div",[n("label",{attrs:{for:"scale"}},[t._v("Scale")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.scene.scale,expression:"scene.scale",modifiers:{number:!0}}],attrs:{id:"scale",type:"number",min:"0.1",step:"0.1"},domProps:{value:t.scene.scale},on:{input:function(e){e.target.composing||t.$set(t.scene,"scale",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),n("label",{attrs:{for:"orientation"}},[t._v("Orientation")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.scene.orientation,expression:"scene.orientation"}],attrs:{id:"orientation"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.scene,"orientation",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:"vert"}},[t._v("Vertical")]),n("option",{attrs:{value:"hor"}},[t._v("Horizontal")])])])]),n("simple-flowchart",{attrs:{scene:t.scene,height:800},on:{"update:scene":function(e){t.scene=e},nodeClick:t.nodeClick,nodeDelete:t.nodeDelete,linkBreak:t.linkBreak,linkAdded:t.linkAdded,canvasClick:t.canvasClick}})],1)},s=[],r=n("75fc"),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flowchart-container",on:{mousemove:t.handleMove,mouseup:t.handleUp,mousedown:t.handleDown}},[n("svg",{attrs:{width:"100%",height:t.height+"px"}},t._l(t.lines,(function(e){return n("flowchart-link",t._b({key:e.id,attrs:{options:t.linkOptions},on:{deleteLink:function(n){return t.linkDelete(e.id)}}},"flowchart-link",e,!1,!0))})),1),t._l(t.scene.nodes,(function(e){return n("flowchart-node",t._b({key:e.id,attrs:{options:t.nodeOptions},on:{linkingStart:function(n){return t.linkingStart(e.id)},linkingStop:function(n){return t.linkingStop(e.id)},nodeSelected:function(n){return t.nodeSelected(e.id,n)}}},"flowchart-node",e,!1,!0))}))],2)},a=[],c=(n("8e6e"),n("ac6a"),n("456d"),n("20d6"),n("7514"),n("768b")),u=n("bd86"),d=(n("c5f6"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{on:{mouseover:t.handleMouseOver,mouseleave:t.handleMouseLeave}},[n("path",{style:t.pathStyle,attrs:{d:t.dAttr}}),t.show.delete?n("a",{on:{click:t.deleteLink}},[n("path",{style:t.deleteStyle,attrs:{d:"M -4 -4 L 4 4 M 4 -4 L -4 4",transform:t.arrowTransform}})]):n("path",{style:t.arrowStyle,attrs:{d:"M -1 -1 L 0 1 L 1 -1 z",transform:t.arrowTransform}})])}),h=[],f={name:"FlowchartLink",props:{start:{type:Array,default:function(){return[0,0]}},end:{type:Array,default:function(){return[0,0]}},id:Number,options:{type:Object,default:function(){return{scale:1,themeColor:"",labelColor:"",linkWidth:2.73205}}}},data:function(){return{show:{delete:!1}}},methods:{handleMouseOver:function(){this.id&&(this.show.delete=!0)},handleMouseLeave:function(){this.show.delete=!1},calculateCenterPoint:function(){var t=(this.end[0]-this.start[0])/2,e=(this.end[1]-this.start[1])/2;return[this.start[0]+t,this.start[1]+e]},calculateRotation:function(){var t=-Math.atan2(this.end[0]-this.start[0],this.end[1]-this.start[1]),e=180*t/Math.PI;return e<0?e+360:e},deleteLink:function(){this.$emit("deleteLink")}},computed:{pathStyle:function(){return{stroke:this.options.themeColor,strokeWidth:this.options.linkWidth*this.options.scale,fill:"none"}},deleteStyle:function(){return{stroke:this.options.labelColor,strokeWidth:.8*this.options.linkWidth,fill:"none"}},arrowStyle:function(){return{stroke:this.options.themeColor,strokeWidth:2*this.options.linkWidth,fill:"none"}},arrowTransform:function(){var t=this.calculateCenterPoint(),e=Object(c["a"])(t,2),n=e[0],o=e[1],i=this.calculateRotation();return"translate(".concat(n,", ").concat(o,") rotate(").concat(i,") scale(").concat(this.options.scale,")")},dAttr:function(){var t=this.start[0],e=this.start[1],n=this.end[0],o=this.end[1],i=t,s=e+50,r=n,l=o-50;return"M ".concat(t,", ").concat(e," C ").concat(i,", ").concat(s,", ").concat(r,", ").concat(l,", ").concat(n,", ").concat(o)}}},p=f,m=(n("dfd7"),n("2877")),g=Object(m["a"])(p,d,h,!1,null,"2bdb7ce6",null),v=g.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flowchart-node",class:[{selected:t.options.selected===t.id},"vert"===t.options.orientation?"vert":"hor"],style:t.nodeStyle,on:{mousedown:function(e){return e.preventDefault(),t.handleMousedown(e)},mouseover:t.handleMouseOver,mouseleave:t.handleMouseLeave}},[n("div",{staticClass:"node-port node-input",on:{mousedown:t.inputMouseDown,mouseup:function(e){return e.preventDefault(),t.inputMouseUp(e)}}}),n("div",{staticClass:"node-main"},[n("div",{staticClass:"node-type",domProps:{textContent:t._s(t.type)}}),n("div",{staticClass:"node-label",domProps:{textContent:t._s(t.label)}})]),n("div",{staticClass:"node-port node-output",on:{mousedown:function(e){return e.preventDefault(),t.outputMouseDown(e)}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.show.delete,expression:"show.delete"}],staticClass:"node-delete"},[t._v("Ã—")])])},b=[],k={name:"FlowchartNode",props:{id:{default:1e3},x:{type:Number,default:0,validator:function(t){return"number"===typeof t}},y:{type:Number,default:0,validator:function(t){return"number"===typeof t}},type:{type:String,default:"Default"},label:{type:String,default:"input name"},options:{type:Object,default:function(){return{centerX:1024,centerY:140,scale:1,selected:!1,orientation:"vert",width:80,height:80,themeColor:"",nodeBgColor:"",typeColor:"",labelColor:""}}}},data:function(){return{show:{delete:!1}}},computed:{nodeStyle:function(){return{top:this.options.centerY+this.y*this.options.scale+"px",left:this.options.centerX+this.x*this.options.scale+"px",transform:"scale(".concat(this.options.scale,")"),width:this.options.width+"px",height:this.options.height+"px","--theme-color":this.options.themeColor,"--node-bgcolor":this.options.nodeBgColor,"--type-color":this.options.typeColor,"--label-color":this.options.labelColor}}},methods:{handleMousedown:function(t){var e=t.target||t.srcElement;e.className.indexOf("node-input")<0&&e.className.indexOf("node-output")<0&&this.$emit("nodeSelected",t)},handleMouseOver:function(){this.show.delete=!0},handleMouseLeave:function(){this.show.delete=!1},outputMouseDown:function(){this.$emit("linkingStart")},inputMouseDown:function(t){t.preventDefault()},inputMouseUp:function(){this.$emit("linkingStop")}}},w=k,O=(n("aac1"),Object(m["a"])(w,y,b,!1,null,"14c85f2b",null)),C=O.exports;function S(t){var e=t.getBoundingClientRect(),n=window.pageYOffset,o=window.pageXOffset,i=e.top+n,s=e.left+o;return{top:Math.round(i),left:Math.round(s)}}function j(t,e){var n=e.pageX||e.clientX+document.documentElement.scrollLeft,o=e.pageY||e.clientY+document.documentElement.scrollTop,i=S(t),s=n-i.left,r=o-i.top;return[s,r]}function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(u["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var L=80,_=80,M="#ff8855",D="#fff",P="#fff",$="#2c3e50",W=2.73205,X=8,Y=100,A={name:"VueFlowchart",props:{scene:{type:Object,default:function(){return{centerX:1024,scale:1,centerY:140,nodes:[],links:[],orientation:"vert",styles:{nodeWidth:L,nodeHeight:_,themeColor:M,nodeBgColor:D,typeColor:P,labelColor:$,linkWidth:W}}}},height:{type:Number,default:400}},data:function(){return{action:{linking:!1,dragging:!1,scrolling:!1,selected:0},mouse:{x:0,y:0,lastX:0,lastY:0},draggingLink:null,rootDivOffset:{top:0,left:0}}},components:{FlowchartLink:v,FlowchartNode:C},computed:{scale:function(){return this.scene.scale||1},orientation:function(){return this.scene.orientation||"vert"},styles:function(){return N({},{nodeWidth:L,nodeHeight:_,themeColor:M,nodeBgColor:D,typeColor:P,labelColor:$,linkWidth:W},{},this.scene.styles)},nodeOptions:function(){return{centerY:this.scene.centerY,centerX:this.scene.centerX,scale:this.scale,selected:this.action.selected,orientation:this.orientation,width:this.styles.nodeWidth,height:this.styles.nodeHeight,themeColor:this.styles.themeColor,nodeBgColor:this.styles.nodeBgColor,typeColor:this.styles.typeColor,labelColor:this.styles.labelColor}},linkOptions:function(){return{scale:this.scale,themeColor:this.styles.themeColor,labelColor:this.styles.labelColor,linkWidth:this.styles.linkWidth}},lines:function(){var t=this,e=this.scene.links.map((function(e){var n=t.findNodeWithID(e.from),o=t.findNodeWithID(e.to),i=t.getPortPosition(n,"output"),s=Object(c["a"])(i,2),r=s[0],l=s[1],a=t.getPortPosition(o,"input"),u=Object(c["a"])(a,2),d=u[0],h=u[1];return{start:[r,l],end:[d,h],id:e.id}}));if(this.draggingLink){var n=this.findNodeWithID(this.draggingLink.from),o=this.getPortPosition(n,"output"),i=Object(c["a"])(o,2),s=i[0],r=i[1];e.push({start:[s,r],end:[this.draggingLink.mx,this.draggingLink.my]})}return e}},mounted:function(){this.rootDivOffset.top=this.$el?this.$el.offsetTop:0,this.rootDivOffset.left=this.$el?this.$el.offsetLeft:0},methods:{findNodeWithID:function(t){return this.scene.nodes.find((function(e){return t===e.id}))},getPortPosition:function(t,e){var n=this.orientation,o=this.scale,i=this.scene.centerX+t.x*o,s=this.scene.centerY+t.y*o,r=this.styles.nodeWidth,l=this.styles.nodeHeight;if("vert"===n){var a=i+r/2*o;return"input"===e?[a,s]:[a,s+l*o]}var c=s+l/2*o;return"input"===e?[i,c]:[i+r*o,c]},linkingStart:function(t){var e=this.findNodeWithID(t),n=this.getPortPosition(e,"output"),o=Object(c["a"])(n,2),i=o[0],s=o[1];this.action.linking=!0,this.draggingLink={from:t,mx:i,my:s}},linkingStop:function(t){var e=this;if(this.draggingLink&&this.draggingLink.from!==t){var n=this.scene.links.find((function(n){return n.from===e.draggingLink.from&&n.to===t}));if(!n){var o=Math.max.apply(Math,[0].concat(Object(r["a"])(this.scene.links.map((function(t){return t.id}))))),i={id:o+1,from:this.draggingLink.from,to:t};this.scene.links.push(i),this.$emit("linkAdded",i)}}this.draggingLink=null},linkDelete:function(t){var e=this.scene.links.find((function(e){return e.id===t}));e&&(this.scene.links=this.scene.links.filter((function(e){return e.id!==t})),this.$emit("linkBreak",e))},nodeSelected:function(t,e){this.action.dragging=t,this.action.selected=t,this.$emit("nodeClick",t);var n=j(this.$el,e),o=Object(c["a"])(n,2);this.mouse.lastX=o[0],this.mouse.lastY=o[1]},handleMove:function(t){if(this.action.linking){var e=j(this.$el,t),n=Object(c["a"])(e,2);this.draggingLink.mx=n[0],this.draggingLink.my=n[1]}else if(this.action.dragging){var o=j(this.$el,t),i=Object(c["a"])(o,2),s=i[0],r=i[1],l=s-this.mouse.lastX,a=r-this.mouse.lastY;this.mouse.lastX=s,this.mouse.lastY=r,this.mouse.lastEvent=t,this.moveSelectedNode(l,a),this.startAutoScroll()}else if(this.action.scrolling){var u=j(this.$el,t),d=Object(c["a"])(u,2),h=d[0],f=d[1],p=h-this.mouse.lastX,m=f-this.mouse.lastY;this.mouse.lastX=h,this.mouse.lastY=f,this.scene.centerX+=p,this.scene.centerY+=m}},handleUp:function(t){var e=t.target||t.srcElement;this.$el.contains(e)&&(("string"!==typeof e.className||e.className.indexOf("node-input")<0)&&(this.draggingLink=null),"string"===typeof e.className&&e.className.indexOf("node-delete")>-1&&this.nodeDelete(this.action.dragging)),this.action.linking=!1,this.action.dragging=null,this.action.scrolling=!1,this.stopAutoScroll()},handleDown:function(t){var e=t.target||t.srcElement;if((e===this.$el||e.matches("svg, svg *"))&&1===t.which){this.action.scrolling=!0;var n=j(this.$el,t),o=Object(c["a"])(n,2);this.mouse.lastX=o[0],this.mouse.lastY=o[1],this.action.selected=null}this.$emit("canvasClick",t)},moveSelectedNode:function(t,e){var n=this,o=this.scene.nodes.findIndex((function(t){return t.id===n.action.dragging})),i=this.scene.nodes[o],s=i.x+t/this.scale,r=i.y+e/this.scale;this.$set(this.scene.nodes,o,Object.assign(i,{x:s,y:r}))},startAutoScroll:function(){this.autoScrollId||(this.autoScrollId=setInterval(this.autoScroll.bind(this),Y))},stopAutoScroll:function(){this.autoScrollId&&(clearInterval(this.autoScrollId),this.autoScrollId=null)},autoScroll:function(){var t=j(this.$el,this.mouse.lastEvent),e=Object(c["a"])(t,2),n=e[0],o=e[1],i=this.$el.getBoundingClientRect(),s=i.width,r=i.height,l=this.styles.nodeWidth/2,a=this.styles.nodeHeight/2,u=0,d=0;n<l?u=-X:s-n<l&&(u=X),o<a?d=-X:r-o<a&&(d=X),0===u&&0===d||(this.moveSelectedNode(u,d),this.scene.centerX-=u,this.scene.centerY-=d)},nodeDelete:function(t){this.scene.nodes=this.scene.nodes.filter((function(e){return e.id!==t})),this.scene.links=this.scene.links.filter((function(e){return e.from!==t&&e.to!==t})),this.$emit("nodeDelete",t)}}},I=A,E=(n("14ba"),Object(m["a"])(I,l,a,!1,null,"4b5bf75b",null)),T=E.exports,B={name:"app",components:{SimpleFlowchart:T},data:function(){return{scene:{centerX:1024,centerY:140,scale:1,nodes:[{id:"test1",x:-700,y:-69,type:"Action",label:"test1"},{id:4,x:-357,y:80,type:"Script",label:"test2"},{id:"test3",x:-557,y:80,type:"Rule",label:"test3"}],links:[{id:3,from:"test1",to:4}],orientation:"vert"},newNodeType:0,newNodeLabel:"",nodeCategory:["rule","action","script","decision","fork","join"]}},methods:{canvasClick:function(t){console.log("canvas Click, event:",t)},addNode:function(){var t=Math.max.apply(Math,[0].concat(Object(r["a"])(this.scene.nodes.map((function(t){return t.id})))));this.scene.nodes.push({id:t+1,x:-400,y:50,type:this.nodeCategory[this.newNodeType],label:this.newNodeLabel?this.newNodeLabel:"test".concat(t+1)})},nodeClick:function(t){console.log("node click",t)},nodeDelete:function(t){console.log("node delete",t)},linkBreak:function(t){console.log("link break",t)},linkAdded:function(t){console.log("new link added:",t)}}},F=B,H=(n("5c0b"),Object(m["a"])(F,i,s,!1,null,null,null)),R=H.exports;o["a"].config.productionTip=!1,new o["a"]({render:function(t){return t(R)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var o=n("e332"),i=n.n(o);i.a},"7da2":function(t,e,n){},aac1:function(t,e,n){"use strict";var o=n("047d"),i=n.n(o);i.a},dfd7:function(t,e,n){"use strict";var o=n("7da2"),i=n.n(o);i.a},e332:function(t,e,n){},e6c2:function(t,e,n){}});
//# sourceMappingURL=app.1210f697.js.map