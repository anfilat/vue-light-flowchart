(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["vue-light-flowchart"]=e():t["vue-light-flowchart"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({1794:function(t,e,n){"use strict";var i=n("a0b9"),o=n.n(i);o.a},2552:function(t,e,n){},4584:function(t,e,n){"use strict";var i=n("2552"),o=n.n(i);o.a},"86e5":function(t,e,n){},a0b9:function(t,e,n){},dc8b:function(t,e,n){"use strict";var i=n("86e5"),o=n.n(i);o.a},f6fd:function(t,e){(function(t){var e="currentScript",n=t.getElementsByTagName("script");e in t||Object.defineProperty(t,e,{get:function(){try{throw new Error}catch(i){var t,e=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(i.stack)||[!1])[1];for(t in n)if(n[t].src==e||"interactive"==n[t].readyState)return n[t];return null}}})})(document)},fb15:function(t,e,n){"use strict";var i;(n.r(e),"undefined"!==typeof window)&&(n("f6fd"),(i=window.document.currentScript)&&(i=i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(n.p=i[1]));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flowchart-container",on:{mousemove:t.handleMove,mouseup:t.handleUp,mousedown:t.handleDown}},[n("svg",{attrs:{width:"100%",height:t.height+"px"}},t._l(t.lines,(function(e){return n("flowchart-link",t._b({key:e.id,attrs:{options:t.linkOptions},on:{linkMouseEnter:function(n){return t.linkMouseEnter(e.id)},linkMouseLeave:function(n){return t.linkMouseLeave(e.id)},linkClick:function(n){return t.linkClick(e.id)},deleteLink:function(n){return t.linkDelete(e.id)}}},"flowchart-link",e,!1,!0))})),1),t._l(t.scene.nodes,(function(e){return n("flowchart-node",t._b({key:e.id,attrs:{options:t.nodeOptions},on:{linkingStart:function(n){return t.linkingStart(e.id)},linkingStop:function(n){return t.linkingStop(e.id)},nodeMouseEnter:function(n){return t.nodeMouseEnter(e.id)},nodeMouseLeave:function(n){return t.nodeMouseLeave(e.id)},nodeSelected:function(n){return t.nodeSelected(e.id,n)}}},"flowchart-node",e,!1,!0))}))],2)},r=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{on:{mousedown:t.handleClick,mouseenter:t.handleMouseEnter,mouseleave:t.handleMouseLeave}},[n("path",{style:t.pathStyle,attrs:{d:t.dAttr}}),t.show.delete?n("a",{on:{click:t.deleteLink}},[n("circle",{attrs:{cx:"0",cy:"0",r:"8","fill-opacity":"0",transform:t.arrowTransform}}),n("path",{style:t.deleteStyle,attrs:{d:"M -4 -4 L 4 4 M 4 -4 L -4 4",transform:t.arrowTransform}})]):n("path",{style:t.arrowStyle,attrs:{d:"M -1 -1 L 0 1 L 1 -1 z",transform:t.arrowTransform}})])},l=[];function a(t,e){return d(t)||u(t,e)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function u(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],i=!0,o=!1,r=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)if(n.push(s.value),e&&n.length===e)break}catch(a){o=!0,r=a}finally{try{i||null==l["return"]||l["return"]()}finally{if(o)throw r}}return n}}function d(t){if(Array.isArray(t))return t}var h={name:"FlowchartLink",props:{id:Number,color:String,start:{type:Array,default:function(){return[0,0]}},end:{type:Array,default:function(){return[0,0]}},options:{type:Object,default:function(){return{scale:1,themeColor:"",labelColor:"",linkWidth:2.73205}}}},data:function(){return{show:{delete:!1}}},methods:{handleClick:function(){this.$emit("linkClick")},handleMouseEnter:function(){this.id&&(this.show.delete=!0,this.$emit("linkMouseEnter"))},handleMouseLeave:function(){this.show.delete=!1,this.$emit("linkMouseLeave")},calculateCenterPoint:function(){var t=(this.end[0]-this.start[0])/2,e=(this.end[1]-this.start[1])/2;return[this.start[0]+t,this.start[1]+e]},calculateRotation:function(){var t=this.bezierDots(),e=a(t,2),n=e[0],i=e[1],o=.75*(n[3]+n[2]-n[1]-n[0]),r=.75*(i[3]+i[2]-i[1]-i[0]),s=-Math.atan2(o,r),l=180*s/Math.PI;return l<0?l+360:l},bezierDots:function(){var t=this.start[0],e=this.start[1],n=this.end[0],i=this.end[1],o=t,r=e+50,s=n,l=i-50;return[[t,o,s,n],[e,r,l,i]]},deleteLink:function(){this.$emit("deleteLink")}},computed:{pathStyle:function(){return{stroke:this.color||this.options.themeColor,strokeWidth:this.options.linkWidth*this.options.scale,fill:"none"}},deleteStyle:function(){return{stroke:this.options.labelColor,strokeWidth:.8*this.options.linkWidth,fill:"none"}},arrowStyle:function(){return{stroke:this.color||this.options.themeColor,strokeWidth:2*this.options.linkWidth,fill:"none"}},arrowTransform:function(){var t=this.calculateCenterPoint(),e=a(t,2),n=e[0],i=e[1],o=this.calculateRotation();return"translate(".concat(n,", ").concat(i,") rotate(").concat(o,") scale(").concat(this.options.scale,")")},dAttr:function(){var t=this.bezierDots(),e=a(t,2),n=e[0],i=e[1];return"M ".concat(n[0],", ").concat(i[0]," C ").concat(n[1],", ").concat(i[1],", ").concat(n[2],", ").concat(i[2],", ").concat(n[3],", ").concat(i[3])}}},f=h;n("4584");function p(t,e,n,i,o,r,s,l){var a,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),i&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),s?(a=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},c._ssrRegister=a):o&&(a=l?function(){o.call(this,this.$root.$options.shadowRoot)}:o),a)if(c.functional){c._injectStyles=a;var u=c.render;c.render=function(t,e){return a.call(e),u(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,a):[a]}return{exports:t,options:c}}var g=p(f,s,l,!1,null,"2d262f38",null),m=g.exports,v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flowchart-node",class:[{selected:t.isSelected},t.options.orientation],style:t.nodeStyle,on:{mousedown:function(e){return e.preventDefault(),t.handleMousedown(e)},mouseenter:t.handleMouseEnter,mouseleave:t.handleMouseLeave}},[n("div",{staticClass:"node-port node-input",on:{mousedown:t.inputMouseDown,mouseup:function(e){return e.preventDefault(),t.inputMouseUp(e)}}}),n("div",{staticClass:"node-main"},[n("div",{staticClass:"node-type",domProps:{textContent:t._s(t.type)}}),n("div",{staticClass:"node-label",domProps:{textContent:t._s(t.label)}})]),n("div",{staticClass:"node-port node-output",on:{mousedown:function(e){return e.preventDefault(),t.outputMouseDown(e)}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.show.delete,expression:"show.delete"}],staticClass:"node-delete"},[t._v("Ã—")])])},y=[],k={name:"FlowchartNode",props:{id:{default:1e3},x:{type:Number,default:0,validator:function(t){return"number"===typeof t}},y:{type:Number,default:0,validator:function(t){return"number"===typeof t}},type:{type:String,default:"Default"},label:{type:String,default:"input name"},borderColor:String,options:{type:Object,default:function(){return{centerX:1024,centerY:140,scale:1,selected:null,orientation:"vert",width:80,height:80,themeColor:"",nodeBgColor:"",typeColor:"",labelColor:""}}}},data:function(){return{show:{delete:!1}}},computed:{isSelected:function(){return this.options.selected===this.id},nodeStyle:function(){var t={top:this.options.centerY+this.y*this.options.scale+"px",left:this.options.centerX+this.x*this.options.scale+"px",transform:"scale(".concat(this.options.scale,")"),width:this.options.width+"px",height:this.options.height+"px","--theme-color":this.options.themeColor,"--node-bgcolor":this.options.nodeBgColor,"--type-color":this.options.typeColor,"--label-color":this.options.labelColor};return this.borderColor&&!this.isSelected&&(t["box-shadow"]="0 0 0 2px ".concat(this.borderColor)),t}},methods:{handleMousedown:function(t){var e=t.target||t.srcElement;e.className.indexOf("node-input")<0&&e.className.indexOf("node-output")<0&&this.$emit("nodeSelected",t)},handleMouseEnter:function(){this.show.delete=!0,this.$emit("nodeMouseEnter")},handleMouseLeave:function(){this.show.delete=!1,this.$emit("nodeMouseLeave")},outputMouseDown:function(){this.$emit("linkingStart")},inputMouseDown:function(t){t.preventDefault()},inputMouseUp:function(){this.$emit("linkingStop")}}},b=k,w=(n("1794"),p(b,v,y,!1,null,"8041ace8",null)),C=w.exports;function S(t){var e=t.getBoundingClientRect(),n=window.pageYOffset,i=window.pageXOffset,o=e.top+n,r=e.left+i;return{top:Math.round(o),left:Math.round(r)}}function M(t,e){var n=e.pageX||e.clientX+document.documentElement.scrollLeft,i=e.pageY||e.clientY+document.documentElement.scrollTop,o=S(t),r=n-o.left,s=i-o.top;return[r,s]}function O(t){return $(t)||x(t)||L()}function L(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function x(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function $(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function j(t,e){return D(t)||E(t,e)||_()}function _(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function E(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],i=!0,o=!1,r=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)if(n.push(s.value),e&&n.length===e)break}catch(a){o=!0,r=a}finally{try{i||null==l["return"]||l["return"]()}finally{if(o)throw r}}return n}}function D(t){if(Array.isArray(t))return t}function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){W(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function W(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var A=80,X=80,I="#ff8855",Y="#fff",T="#fff",B="#2c3e50",R=2.73205,F=8,U=100,H={name:"VueLightFlowchart",props:{scene:{type:Object,default:function(){return{centerX:1024,scale:1,centerY:140,nodes:[],links:[],orientation:"vert",styles:{nodeWidth:A,nodeHeight:X,themeColor:I,nodeBgColor:Y,typeColor:T,labelColor:B,linkWidth:R}}}},height:{type:Number,default:400}},data:function(){return{action:{linking:!1,dragging:!1,scrolling:!1,selected:0},mouse:{x:0,y:0,lastX:0,lastY:0},draggingLink:null,rootDivOffset:{top:0,left:0}}},components:{FlowchartLink:m,FlowchartNode:C},computed:{scale:function(){return this.scene.scale||1},orientation:function(){return this.scene.orientation||"vert"},styles:function(){return N({},{nodeWidth:A,nodeHeight:X,themeColor:I,nodeBgColor:Y,typeColor:T,labelColor:B,linkWidth:R},{},this.scene.styles)},nodeOptions:function(){return{centerY:this.scene.centerY,centerX:this.scene.centerX,scale:this.scale,selected:this.action.selected,orientation:this.orientation,width:this.styles.nodeWidth,height:this.styles.nodeHeight,themeColor:this.styles.themeColor,nodeBgColor:this.styles.nodeBgColor,typeColor:this.styles.typeColor,labelColor:this.styles.labelColor}},linkOptions:function(){return{scale:this.scale,themeColor:this.styles.themeColor,labelColor:this.styles.labelColor,linkWidth:this.styles.linkWidth}},lines:function(){var t=this,e=this.scene.links.map((function(e){var n=t.findNodeWithID(e.from),i=t.findNodeWithID(e.to),o=t.getPortPosition(n,"output"),r=j(o,2),s=r[0],l=r[1],a=t.getPortPosition(i,"input"),c=j(a,2),u=c[0],d=c[1];return{start:[s,l],end:[u,d],id:e.id,color:e.color}}));if(this.draggingLink){var n=this.findNodeWithID(this.draggingLink.from),i=this.getPortPosition(n,"output"),o=j(i,2),r=o[0],s=o[1];e.push({start:[r,s],end:[this.draggingLink.mx,this.draggingLink.my]})}return e}},mounted:function(){this.rootDivOffset.top=this.$el?this.$el.offsetTop:0,this.rootDivOffset.left=this.$el?this.$el.offsetLeft:0},methods:{findNodeWithID:function(t){return this.scene.nodes.find((function(e){return t===e.id}))},getPortPosition:function(t,e){var n=this.orientation,i=this.scale,o=this.scene.centerX+t.x*i,r=this.scene.centerY+t.y*i,s=this.styles.nodeWidth,l=this.styles.nodeHeight;if("vert"===n){var a=o+s/2*i;return"input"===e?[a,r]:[a,r+l*i]}var c=r+l/2*i;return"input"===e?[o,c]:[o+s*i,c]},linkingStart:function(t){var e=this.findNodeWithID(t),n=this.getPortPosition(e,"output"),i=j(n,2),o=i[0],r=i[1];this.action.linking=!0,this.draggingLink={from:t,mx:o,my:r}},linkingStop:function(t){var e=this;if(this.draggingLink&&this.draggingLink.from!==t){var n=this.scene.links.find((function(n){return n.from===e.draggingLink.from&&n.to===t}));if(!n){var i=Math.max.apply(Math,[0].concat(O(this.scene.links.map((function(t){return t.id}))))),o={id:i+1,from:this.draggingLink.from,to:t};this.scene.links.push(o),this.$emit("linkAdded",o)}}this.draggingLink=null},linkClick:function(t){this.$emit("linkClick",this.findLink(t))},linkDelete:function(t){var e=this.findLink(t);e&&(this.scene.links=this.scene.links.filter((function(e){return e.id!==t})),this.$emit("linkBreak",e))},linkMouseEnter:function(t){this.action.dragging||this.$emit("linkMouseEnter",this.findLink(t))},linkMouseLeave:function(t){this.action.dragging||this.$emit("linkMouseLeave",this.findLink(t))},findLink:function(t){return this.scene.links.find((function(e){return e.id===t}))},nodeSelected:function(t,e){this.action.dragging=t,this.action.selected=t,this.$emit("nodeClick",t);var n=M(this.$el,e),i=j(n,2);this.mouse.lastX=i[0],this.mouse.lastY=i[1]},handleMove:function(t){if(this.action.linking){var e=M(this.$el,t),n=j(e,2);this.draggingLink.mx=n[0],this.draggingLink.my=n[1]}else if(this.action.dragging){var i=M(this.$el,t),o=j(i,2),r=o[0],s=o[1],l=r-this.mouse.lastX,a=s-this.mouse.lastY;this.mouse.lastX=r,this.mouse.lastY=s,this.mouse.lastEvent=t,this.moveSelectedNode(l,a),this.startAutoScroll()}else if(this.action.scrolling){var c=M(this.$el,t),u=j(c,2),d=u[0],h=u[1],f=d-this.mouse.lastX,p=h-this.mouse.lastY;this.mouse.lastX=d,this.mouse.lastY=h,this.scene.centerX+=f,this.scene.centerY+=p}},handleUp:function(t){var e=t.target||t.srcElement;this.$el.contains(e)&&(("string"!==typeof e.className||e.className.indexOf("node-input")<0)&&(this.draggingLink=null),"string"===typeof e.className&&e.className.indexOf("node-delete")>-1&&this.nodeDelete(this.action.dragging)),this.action.linking=!1,this.action.dragging=null,this.action.scrolling=!1,this.stopAutoScroll()},handleDown:function(t){var e=t.target||t.srcElement;if((e===this.$el||e.matches("svg, svg *"))&&1===t.which){this.action.scrolling=!0;var n=M(this.$el,t),i=j(n,2);this.mouse.lastX=i[0],this.mouse.lastY=i[1],this.action.selected=null}this.$emit("canvasClick",t)},moveSelectedNode:function(t,e){var n=this,i=this.scene.nodes.findIndex((function(t){return t.id===n.action.dragging})),o=this.scene.nodes[i],r=o.x+t/this.scale,s=o.y+e/this.scale;this.$set(this.scene.nodes,i,Object.assign(o,{x:r,y:s}))},startAutoScroll:function(){this.autoScrollId||(this.autoScrollId=setInterval(this.autoScroll.bind(this),U))},stopAutoScroll:function(){this.autoScrollId&&(clearInterval(this.autoScrollId),this.autoScrollId=null)},autoScroll:function(){var t=M(this.$el,this.mouse.lastEvent),e=j(t,2),n=e[0],i=e[1],o=this.$el.getBoundingClientRect(),r=o.width,s=o.height,l=this.styles.nodeWidth/2,a=this.styles.nodeHeight/2,c=0,u=0;n<l?c=-F:r-n<l&&(c=F),i<a?u=-F:s-i<a&&(u=F),0===c&&0===u||(this.moveSelectedNode(c,u),this.scene.centerX-=c,this.scene.centerY-=u)},nodeDelete:function(t){this.scene.nodes=this.scene.nodes.filter((function(e){return e.id!==t})),this.scene.links=this.scene.links.filter((function(e){return e.from!==t&&e.to!==t})),this.$emit("nodeDelete",t)},nodeMouseEnter:function(t){this.action.dragging||this.$emit("nodeMouseEnter",t)},nodeMouseLeave:function(t){this.action.dragging||this.$emit("nodeMouseLeave",t)}}},z=H,V=(n("dc8b"),p(z,o,r,!1,null,"29f1701c",null)),q=V.exports,G=q;e["default"]=G}})}));
//# sourceMappingURL=vue-light-flowchart.umd.min.js.map